---
import Layout from "../components/Layout.astro";
---

<Layout title="Welcome to Nested Wisdom">
  <div style="max-width: 700px; margin: auto; padding: 2rem;">
    <h1 style="text-align: center;">ðŸ¦œ Talk to Lily or Bingo</h1>
    <input id="userInput" placeholder="Ask your question..." style="width: 100%; padding: 0.5rem; margin-top: 1rem;" />

    <div style="text-align: center; margin-top: 1rem;">
      <button onclick="sendTo('lily')">Talk to Lily</button>
      <button onclick="sendTo('bingo')">Talk to Bingo</button>
    </div>

    <div id="chatOutput" style="margin-top: 2rem; white-space: pre-wrap;"></div>
  </div>

  <script type="module">
    async function sendTo(character: string) {
      const input = document.getElementById("userInput") as HTMLInputElement;
      const chatBox = document.getElementById("chatOutput");

      if (!input || !chatBox) return;

      const message = input.value;

      const res = await fetch("/.netlify/functions/askOpenAI", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ character, message })
      });

      const reply = await res.text();
      chatBox.textContent = reply;
    }
  </script>
</Layout>
